---
title: "Airbnb_8"
output: html_document
---

```{r load_packages, warning=FALSE, message=FALSE, echo=FALSE}
library(tidyverse)
library(mosaic)
library(ggfortify)
library(moderndive)
library(janitor)
library(huxtable)
library(here)
library(broom)
library(skimr)
library(GGally)
library(car)
library(vroom)
library(GGally)
```

price = cost per night

cleaning_fee: cleaning fee

extra_people: charge for having more than 1 person

property_type: type of accommodation (House, Apartment, etc.)

room_type:

Entire home/apt (guests have entire place to themselves)
Private room (Guests have private room to sleep, all other rooms shared)
Shared room (Guests sleep in room shared with others)
number_of_reviews: Total number of reviews for the listing

review_scores_rating: Average review score (0 - 100)

longitude , latitude: geographical coordinates to help us locate the listing

neighbourhood*: three variables on a few major neighbourhoods in each city

```{r cars}
listings <- vroom("http://data.insideairbnb.com/denmark/hovedstaden/copenhagen/2020-06-26/data/listings.csv.gz") %>% 
    clean_names()  #get the listings for Copenhagen
```



```{r}
glimpse(listings) # Looking at the raw values
skim(listings) #Computing summary statistics of the variables of interest, or finding NAs
```

#EDA

```{r  echo=FALSE}
listings$price = as.numeric(gsub("[\\$,]", "", listings$price)) # make price into a numeric variable
listings$cleaning_fee = as.numeric(gsub("[\\$,]", "", listings$cleaning_fee))

skim(listings) #check if all the variables are in the correct type
```
```{r}

listings_eda<- listings %>%
  select(price, accommodates, beds, guests_included, review_scores_rating, number_of_reviews, neighbourhood_cleansed,   room_type, bedrooms, bathrooms, property_type, cleaning_fee, host_is_superhost)

listings_eda

listings_numeric<- listings %>%
  select(price, accommodates, beds, guests_included, review_scores_rating, number_of_reviews,  bedrooms,  bathrooms,  cleaning_fee) 
#%>%
  #filter(is.na())

listings_categorical<- listings %>%
  select(price, neighbourhood_cleansed, room_type,  room_type,  property_type,  host_is_superhost)

skim(listings_numeric)

#listings <- listings %>%
  #mutate(cleaning_fee = case_when(
   # is.na(cleaning_fee) ~ mean(), 
    #TRUE ~ cleaning_fee
  #))

```
```{r}
library(corrplot)
leaflet(data = filter(listings, minimum_nights <= 4)) %>% 
  addProviderTiles("OpenStreetMap.Mapnik") %>% 
  addCircleMarkers(lng = ~longitude, 
                   lat = ~latitude, 
                   radius = 1, 
                   fillColor = "blue", 
                   fillOpacity = 0.4, 
                   popup = ~listing_url,
                   label = ~property_type
                    )

eda.cor= cor(listings_numeric)

corrplot(cor(listings_numeric))

eda.cor

```
# REGRESSION

